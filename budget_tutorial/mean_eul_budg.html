

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Calculating the mean Eulerian salinity budget in ECCOv4r4 &#8212; Seaduck Tutorial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'budget_tutorial/mean_eul_budg';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tracking Labrador Sea Waterâ€™s with Lagrangian budget" href="particle_bud_tut.html" />
    <link rel="prev" title="Tutorials for Lagrangian tracer budget" href="../bud_tut.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Seaduck Tutorial - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Seaduck Tutorial - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../how_to_install.html">How to install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how_to_cite.html">How to cite</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../get_started.html">Get started</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../one_min_guide.html">One minute guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network_of_object.html">Learn about <code class="docutils literal notranslate"><span class="pre">seaduck</span></code> core objects and functions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../public_api_reference.html">Public API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_OceData.html">seaduck.OceData</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_topology.html">seaduck.topology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_eulerian.html">seaduck.eulerian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_lagrangian.html">seaduck.lagrangian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_OceInterp.html">seaduck.OceInterp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_kernelNweight.html">seaduck.kernel_weight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_eulerian_budget.html">seaduck.eulerian_budget</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_lagrangian_budget.html">seaduck.lagrangian_budget</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../internal_api_reference.html">Internal API reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_smartread.html">seaduck.smart_read</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_getmasks.html">seaduck.get_masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_utils.html">seaduck.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/apiref_RelCoord.html">seaduck.ocedata.RelCoord and subclasses</a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../ideal_test.html">Examples using idealized fields</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../idealize_test/hor_stream.html">Horizontal stream function conservation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../idealize_test/ver_stream.html">Vertical stream function conservation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../idealize_test/tilted_stream.html">Tilted solid-body rotation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ocean_example.html">Examples using ocean datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebook/global_ECCO.html">Use <code class="docutils literal notranslate"><span class="pre">seaduck.OceInterp</span></code> with ECCO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebook/AVISO.html">Use <code class="docutils literal notranslate"><span class="pre">seaduck.Particle</span></code> with AVISO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebook/ASTE_sd.Particle_example.html">Using <code>seaduck.Particle</code> with ASTE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebook/topology_tutorial.html">Topology tutorial</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../sciserver_example.html">Examples using SciServer ocean datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../sciserver_notebooks/IGPwinter.html"><code class="docutils literal notranslate"><span class="pre">Particle</span></code> in an East Greenland regional simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sciserver_notebooks/KangerFjord.html">Demonstrate <code class="docutils literal notranslate"><span class="pre">eulerian.Position</span></code> object with Fjord</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sciserver_notebooks/LLC4320.html">Plot surface streamlines on LLC4320</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sciserver_notebooks/ECCO_plot_stations.html"><code class="docutils literal notranslate"><span class="pre">OceInterp</span></code> interpolation in the ECCO global state estimate.</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../bud_tut.html">Tutorials for Lagrangian tracer budget</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Calculating the mean Eulerian salinity budget in ECCOv4r4</a></li>
<li class="toctree-l2"><a class="reference internal" href="particle_bud_tut.html">Tracking Labrador Sea Waterâ€™s with Lagrangian budget</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../guide_for_developer.html">A guide for new contributors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contribute/use_git.html">Using Git and Github</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/prep_env.html">Prepare the environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/contr_cod.html">Contributing to codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/contr_doc.html">Contributing to documentationðŸ¦†</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/report_iss.html">Report Issues on GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/tidyNpr.html">Tidy it up and make Pull Request</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/budget_tutorial/mean_eul_budg.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Calculating the mean Eulerian salinity budget in ECCOv4r4</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up">0.Set up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-wall-salinity">1. Calculate the wall salinity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-salinity-budget">2. Calculating the Salinity Budget</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-nabla-cdot-overline-u-overline-s">Calculate <span class="math notranslate nohighlight">\(\nabla\cdot{(\overline{u}\overline{S})}\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-divergence-of-adv-and-dif-terms">Calculate the divergence of ADV and DIF terms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-budget-closure">3. Check the budget closure</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="calculating-the-mean-eulerian-salinity-budget-in-eccov4r4">
<h1>Calculating the mean Eulerian salinity budget in ECCOv4r4<a class="headerlink" href="#calculating-the-mean-eulerian-salinity-budget-in-eccov4r4" title="Permalink to this heading">#</a></h1>
<p>Carenza Williams &amp; Wenrui Jiang, Feb 2026</p>
<p>This notebook demonstrates how to calculate the time-mean Eulerian salinity budget in <a class="reference external" href="https://ecco-group.org/products-ECCO-V4r4.htm">ECCOv4r4</a>.</p>
<section id="set-up">
<h2>0.Set up<a class="headerlink" href="#set-up" title="Permalink to this heading">#</a></h2>
<p>Letâ€™s start by loading in our dataset and some key packages.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -----------------</span>
<span class="c1"># Import packages</span>
<span class="c1"># -----------------</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">seaduck</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaduck.eulerian_budget</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sdeb</span>

<span class="c1"># Suppress futurewarning</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">,</span>
                        <span class="n">message</span><span class="o">=</span><span class="s2">&quot;elementwise comparison failed&quot;</span><span class="p">)</span>
<span class="c1"># Suppress xgcm padding warning</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
                        <span class="n">message</span><span class="o">=</span><span class="s2">&quot;rename &#39;Z&#39; to &#39;Z&#39; does not create an index anymore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -----------------------------</span>
<span class="c1"># Load and inspect the dataset</span>
<span class="c1"># -----------------------------</span>

<span class="n">ds_bar</span> <span class="o">=</span> <span class="n">sd</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="s1">&#39;eul_bud_mean&#39;</span><span class="p">)</span>

<span class="c1"># Create cell volume</span>
<span class="n">vol</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">rA</span><span class="o">*</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">drF</span><span class="o">*</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">hFacC</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s1">&#39;face&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;Vol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vol</span>
<span class="n">ds_bar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in notebooks */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
  line-height: 1.6;
  padding-bottom: 4px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
}

.xr-header {
  border-bottom: solid 1px var(--xr-border-color);
  margin-bottom: 4px;
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-obj-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type,
.xr-group-box-contents > label {
  color: var(--xr-font-color2);
  display: block;
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
  margin-block-start: 0;
  margin-block-end: 0;
}

.xr-section-item {
  display: contents;
}

.xr-section-item > input,
.xr-group-box-contents > input,
.xr-array-wrap > input {
  display: block;
  opacity: 0;
  height: 0;
  margin: 0;
}

.xr-section-item > input + label,
.xr-var-item > input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item > input:enabled + label,
.xr-var-item > input:enabled + label,
.xr-array-wrap > input:enabled + label,
.xr-group-box-contents > input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item > input:focus-visible + label,
.xr-var-item > input:focus-visible + label,
.xr-array-wrap > input:focus-visible + label,
.xr-group-box-contents > input:focus-visible + label {
  outline: auto;
}

.xr-section-item > input:enabled + label:hover,
.xr-var-item > input:enabled + label:hover,
.xr-array-wrap > input:enabled + label:hover,
.xr-group-box-contents > input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
  white-space: nowrap;
}

.xr-section-summary > em {
  font-weight: normal;
}

.xr-span-grid {
  grid-column-end: -1;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.3em;
}

.xr-group-box-contents > input:checked + label > span {
  display: inline-block;
  padding-left: 0.6em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "â–º";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "â–¼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details,
.xr-group-box-contents > label {
  padding-top: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  grid-column: 1 / -1;
  margin-top: 4px;
  margin-bottom: 5px;
}

.xr-section-summary-in ~ .xr-section-details {
  display: none;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-children {
  display: inline-grid;
  grid-template-columns: 100%;
  grid-column: 1 / -1;
  padding-top: 4px;
}

.xr-group-box {
  display: inline-grid;
  grid-template-columns: 0px 30px auto;
}

.xr-group-box-vline {
  grid-column-start: 1;
  border-right: 0.2em solid;
  border-color: var(--xr-border-color);
  width: 0px;
}

.xr-group-box-hline {
  grid-column-start: 2;
  grid-row-start: 1;
  height: 1em;
  width: 26px;
  border-bottom: 0.2em solid;
  border-color: var(--xr-border-color);
}

.xr-group-box-contents {
  grid-column-start: 3;
  padding-bottom: 4px;
}

.xr-group-box-contents > label::before {
  content: "ðŸ“‚";
  padding-right: 0.3em;
}

.xr-group-box-contents > input:checked + label::before {
  content: "ðŸ“";
}

.xr-group-box-contents > input:checked + label {
  padding-bottom: 0px;
}

.xr-group-box-contents > input:checked ~ .xr-sections {
  display: none;
}

.xr-group-box-contents > input + label > span {
  display: none;
}

.xr-group-box-ellipsis {
  font-size: 1.4em;
  font-weight: 900;
  color: var(--xr-font-color2);
  letter-spacing: 0.15em;
  cursor: default;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 368MB
Dimensions:       (Z: 50, face: 13, Y: 90, Xp1: 90, Yp1: 90, X: 90, Zl: 50)
Coordinates: (12/20)
  * Z             (Z) float32 200B -5.0 -15.0 -25.0 ... -5.461e+03 -5.906e+03
    PHrefC        (Z) float32 200B dask.array&lt;chunksize=(10,), meta=np.ndarray&gt;
    drF           (Z) float32 200B dask.array&lt;chunksize=(10,), meta=np.ndarray&gt;
    k             (Z) int64 400B dask.array&lt;chunksize=(10,), meta=np.ndarray&gt;
  * face          (face) int64 104B 0 1 2 3 4 5 6 7 8 9 10 11 12
  * Y             (Y) int64 720B 0 1 2 3 4 5 6 7 8 ... 82 83 84 85 86 87 88 89
    ...            ...
    XC            (face, Y, X) float32 421kB dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;
    YC            (face, Y, X) float32 421kB dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;
    hFacC         (Z, face, Y, X) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    maskC         (Z, face, Y, X) int8 5MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    rA            (face, Y, X) float32 421kB dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;
  * Zl            (Zl) float32 200B 0.0 -10.0 -20.0 ... -5.244e+03 -5.678e+03
Data variables: (12/20)
    ADVx_SLT_bar  (Z, face, Y, Xp1) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    ADVy_SLT_bar  (Z, face, Yp1, X) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    ADVz_SLT_bar  (Zl, face, Y, X) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    DFx_SLT_bar   (Z, face, Y, Xp1) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    DFy_SLT_bar   (Z, face, Yp1, X) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    DFz_SLT_bar   (Zl, face, Y, X) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    ...            ...
    spdivup_bar   (Z, face, Y, X) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    tendSln_bar   (Z, face, Y, X) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    u_bar         (Z, face, Y, Xp1) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    v_bar         (Z, face, Yp1, X) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    w_bar         (Zl, face, Y, X) float32 21MB dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;
    Vol           (face, Z, Y, X) float32 21MB dask.array&lt;chunksize=(13, 10, 45, 45), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-09f999e0-5d6a-4ca2-9a6a-dc5ebace78a7' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-09f999e0-5d6a-4ca2-9a6a-dc5ebace78a7' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>Z</span>: 50</li><li><span class='xr-has-index'>face</span>: 13</li><li><span class='xr-has-index'>Y</span>: 90</li><li><span class='xr-has-index'>Xp1</span>: 90</li><li><span class='xr-has-index'>Yp1</span>: 90</li><li><span class='xr-has-index'>X</span>: 90</li><li><span class='xr-has-index'>Zl</span>: 50</li></ul></div></li><li class='xr-section-item'><input id='section-d82b3fa6-2706-4338-96fa-2ab4f22b54e8' class='xr-section-summary-in' type='checkbox' checked /><label for='section-d82b3fa6-2706-4338-96fa-2ab4f22b54e8' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(20)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Z</span></div><div class='xr-var-dims'>(Z)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-5.0 -15.0 ... -5.906e+03</div><input id='attrs-fd7cf27a-ff0c-43de-9515-74e25946e8fc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fd7cf27a-ff0c-43de-9515-74e25946e8fc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-926f2f78-a78b-4bd0-9f6c-6e6e3bb85402' class='xr-var-data-in' type='checkbox'><label for='data-926f2f78-a78b-4bd0-9f6c-6e6e3bb85402' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>vertical coordinate of cell center</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([-5.000000e+00, -1.500000e+01, -2.500000e+01, -3.500000e+01,
       -4.500000e+01, -5.500000e+01, -6.500000e+01, -7.500500e+01,
       -8.502500e+01, -9.509500e+01, -1.053100e+02, -1.158700e+02,
       -1.271500e+02, -1.397400e+02, -1.544700e+02, -1.724000e+02,
       -1.947350e+02, -2.227100e+02, -2.574700e+02, -2.999300e+02,
       -3.506800e+02, -4.099300e+02, -4.774700e+02, -5.527100e+02,
       -6.347350e+02, -7.224000e+02, -8.144700e+02, -9.097400e+02,
       -1.007155e+03, -1.105905e+03, -1.205535e+03, -1.306205e+03,
       -1.409150e+03, -1.517095e+03, -1.634175e+03, -1.765135e+03,
       -1.914150e+03, -2.084035e+03, -2.276225e+03, -2.491250e+03,
       -2.729250e+03, -2.990250e+03, -3.274250e+03, -3.581250e+03,
       -3.911250e+03, -4.264250e+03, -4.640250e+03, -5.039250e+03,
       -5.461250e+03, -5.906250e+03], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>PHrefC</span></div><div class='xr-var-dims'>(Z)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10,), meta=np.ndarray&gt;</div><input id='attrs-786c3940-9534-4b1a-9106-9d3ad00fd615' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-786c3940-9534-4b1a-9106-9d3ad00fd615' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2bc27aaa-f9ff-480c-8609-ed1db441b357' class='xr-var-data-in' type='checkbox'><label for='data-2bc27aaa-f9ff-480c-8609-ed1db441b357' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Reference Hydrostatic Pressure</dd><dt><span>units :</span></dt><dd>m2 s-2</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 200 B </td>
                        <td> 40 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50,) </td>
                        <td> (10,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 5 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="79" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="29" x2="120" y2="29" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="29" style="stroke-width:2" />
  <line x1="24" y1="0" x2="24" y2="29" />
  <line x1="48" y1="0" x2="48" y2="29" />
  <line x1="72" y1="0" x2="72" y2="29" />
  <line x1="96" y1="0" x2="96" y2="29" />
  <line x1="120" y1="0" x2="120" y2="29" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,29.030629010473877 0.0,29.030629010473877" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.0" y="49.030629010473874" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="140.0" y="14.515314505236939" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.0,14.515314505236939)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>drF</span></div><div class='xr-var-dims'>(Z)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10,), meta=np.ndarray&gt;</div><input id='attrs-84d71eed-3b91-43e3-b386-4c5dee034a49' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-84d71eed-3b91-43e3-b386-4c5dee034a49' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff008de0-f372-4c28-bee8-24a97b4827c9' class='xr-var-data-in' type='checkbox'><label for='data-ff008de0-f372-4c28-bee8-24a97b4827c9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>cell z size</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 200 B </td>
                        <td> 40 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50,) </td>
                        <td> (10,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 5 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="79" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="29" x2="120" y2="29" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="29" style="stroke-width:2" />
  <line x1="24" y1="0" x2="24" y2="29" />
  <line x1="48" y1="0" x2="48" y2="29" />
  <line x1="72" y1="0" x2="72" y2="29" />
  <line x1="96" y1="0" x2="96" y2="29" />
  <line x1="120" y1="0" x2="120" y2="29" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,29.030629010473877 0.0,29.030629010473877" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.0" y="49.030629010473874" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="140.0" y="14.515314505236939" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.0,14.515314505236939)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>k</span></div><div class='xr-var-dims'>(Z)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10,), meta=np.ndarray&gt;</div><input id='attrs-6f9f3d3f-13ee-4bb6-a015-3d2d7d5ea97b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6f9f3d3f-13ee-4bb6-a015-3d2d7d5ea97b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c1383962-8eed-4f22-992a-d0b813ea88d7' class='xr-var-data-in' type='checkbox'><label for='data-c1383962-8eed-4f22-992a-d0b813ea88d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Z</dd><dt><span>long_name :</span></dt><dd>z-dimension of the t grid</dd><dt><span>swap_dim :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 400 B </td>
                        <td> 80 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50,) </td>
                        <td> (10,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 5 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="79" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="29" x2="120" y2="29" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="29" style="stroke-width:2" />
  <line x1="24" y1="0" x2="24" y2="29" />
  <line x1="48" y1="0" x2="48" y2="29" />
  <line x1="72" y1="0" x2="72" y2="29" />
  <line x1="96" y1="0" x2="96" y2="29" />
  <line x1="120" y1="0" x2="120" y2="29" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,29.030629010473877 0.0,29.030629010473877" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.0" y="49.030629010473874" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="140.0" y="14.515314505236939" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.0,14.515314505236939)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>face</span></div><div class='xr-var-dims'>(face)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9 10 11 12</div><input id='attrs-9c5d69ea-663d-47f5-9a25-396f70207963' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9c5d69ea-663d-47f5-9a25-396f70207963' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ec1d0a7f-9693-4a5d-8326-9d5a2625a65b' class='xr-var-data-in' type='checkbox'><label for='data-ec1d0a7f-9693-4a5d-8326-9d5a2625a65b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>index of llc grid tile</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Y</span></div><div class='xr-var-dims'>(Y)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 84 85 86 87 88 89</div><input id='attrs-5f4936c7-5724-4cc4-9f57-d620799db423' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5f4936c7-5724-4cc4-9f57-d620799db423' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c8bb889-1069-4676-80a3-6a9626afc1a9' class='xr-var-data-in' type='checkbox'><label for='data-6c8bb889-1069-4676-80a3-6a9626afc1a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y-dimension of the t grid</dd><dt><span>swap_dim :</span></dt><dd>YC</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Xp1</span></div><div class='xr-var-dims'>(Xp1)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 84 85 86 87 88 89</div><input id='attrs-0e900521-96b8-4905-9fbb-e7dc9791c177' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e900521-96b8-4905-9fbb-e7dc9791c177' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2813090c-95fd-4c58-9249-b8912748494e' class='xr-var-data-in' type='checkbox'><label for='data-2813090c-95fd-4c58-9249-b8912748494e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>c_grid_axis_shift :</span></dt><dd>-0.5</dd><dt><span>long_name :</span></dt><dd>x-dimension of the u grid</dd><dt><span>swap_dim :</span></dt><dd>XG</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>XG</span></div><div class='xr-var-dims'>(face, Yp1, Xp1)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-b60f44c0-a6c5-4166-af35-daa80edcf6c3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b60f44c0-a6c5-4166-af35-daa80edcf6c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0848d3dc-4472-4818-ac5d-016b7c184b3b' class='xr-var-data-in' type='checkbox'><label for='data-0848d3dc-4472-4818-ac5d-016b7c184b3b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>YG XG</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>YG</span></div><div class='xr-var-dims'>(face, Yp1, Xp1)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-89fd8bc3-35fd-494d-a7f9-d3e181f9dfb9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-89fd8bc3-35fd-494d-a7f9-d3e181f9dfb9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-77cb3e41-47a7-4c2b-ae8d-52208b5c85c2' class='xr-var-data-in' type='checkbox'><label for='data-77cb3e41-47a7-4c2b-ae8d-52208b5c85c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Yp1</span></div><div class='xr-var-dims'>(Yp1)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 84 85 86 87 88 89</div><input id='attrs-42c5e422-485f-493f-8394-cd0b9c24ef5e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-42c5e422-485f-493f-8394-cd0b9c24ef5e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1a8f977b-53fb-45e4-a4b9-33bb23fe2294' class='xr-var-data-in' type='checkbox'><label for='data-1a8f977b-53fb-45e4-a4b9-33bb23fe2294' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>c_grid_axis_shift :</span></dt><dd>-0.5</dd><dt><span>long_name :</span></dt><dd>y-dimension of the v grid</dd><dt><span>swap_dim :</span></dt><dd>YG</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>X</span></div><div class='xr-var-dims'>(X)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 84 85 86 87 88 89</div><input id='attrs-c04f9f57-bd13-4db8-b259-2247f1853d06' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c04f9f57-bd13-4db8-b259-2247f1853d06' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-93761e10-52c2-4c0f-8949-31b87b81cb99' class='xr-var-data-in' type='checkbox'><label for='data-93761e10-52c2-4c0f-8949-31b87b81cb99' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x-dimension of the t grid</dd><dt><span>swap_dim :</span></dt><dd>XC</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CS</span></div><div class='xr-var-dims'>(face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-3dd49fc1-a461-4471-9345-51c9dd208e0f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3dd49fc1-a461-4471-9345-51c9dd208e0f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2cb71457-a95e-4f87-bd02-62abbe0b87ec' class='xr-var-data-in' type='checkbox'><label for='data-2cb71457-a95e-4f87-bd02-62abbe0b87ec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>YC XC</dd><dt><span>long_name :</span></dt><dd>AngleCS</dd><dt><span>units :</span></dt><dd> </dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Depth</span></div><div class='xr-var-dims'>(face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-0fe33fe7-3af5-414d-8239-fcb2056b4dbb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0fe33fe7-3af5-414d-8239-fcb2056b4dbb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5db79b6e-1ee5-410a-98da-06a24eda53fd' class='xr-var-data-in' type='checkbox'><label for='data-5db79b6e-1ee5-410a-98da-06a24eda53fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>XC YC</dd><dt><span>long_name :</span></dt><dd>ocean depth</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SN</span></div><div class='xr-var-dims'>(face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-d545ab2d-5e4c-4859-9431-aeaca52165d0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d545ab2d-5e4c-4859-9431-aeaca52165d0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ef4ee49-16ea-4561-92d5-34c5120dc087' class='xr-var-data-in' type='checkbox'><label for='data-3ef4ee49-16ea-4561-92d5-34c5120dc087' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>YC XC</dd><dt><span>long_name :</span></dt><dd>AngleSN</dd><dt><span>units :</span></dt><dd> </dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>XC</span></div><div class='xr-var-dims'>(face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-47e2f612-8b3c-4782-8a00-0b2395fbcb69' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-47e2f612-8b3c-4782-8a00-0b2395fbcb69' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5f65d230-3bbe-4b8b-8fef-7cd815478018' class='xr-var-data-in' type='checkbox'><label for='data-5f65d230-3bbe-4b8b-8fef-7cd815478018' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>YC XC</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>YC</span></div><div class='xr-var-dims'>(face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-97aca8b5-0501-470e-9514-2ee0bce0d0f2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-97aca8b5-0501-470e-9514-2ee0bce0d0f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0169471d-99f0-4646-a42b-1768acbfb202' class='xr-var-data-in' type='checkbox'><label for='data-0169471d-99f0-4646-a42b-1768acbfb202' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>YC XC</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hFacC</span></div><div class='xr-var-dims'>(Z, face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-acf8ca80-13dd-44a1-9448-dbd0daab657c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-acf8ca80-13dd-44a1-9448-dbd0daab657c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f63e4e35-f503-49ff-81d1-9deb1cb21c18' class='xr-var-data-in' type='checkbox'><label for='data-f63e4e35-f503-49ff-81d1-9deb1cb21c18' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>vertical fraction of open cell</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>maskC</span></div><div class='xr-var-dims'>(Z, face, Y, X)</div><div class='xr-var-dtype'>int8</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-31a86ee5-4906-4d3b-ba48-cd2635a4d83d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-31a86ee5-4906-4d3b-ba48-cd2635a4d83d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4a704814-b2b8-4ac7-8164-d18854c75a11' class='xr-var-data-in' type='checkbox'><label for='data-4a704814-b2b8-4ac7-8164-d18854c75a11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>mask denoting wet point at center</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 5.02 MiB </td>
                        <td> 257.08 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int8 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rA</span></div><div class='xr-var-dims'>(face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-a37bbabd-ecf4-45a4-b11d-0030bff4eb57' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a37bbabd-ecf4-45a4-b11d-0030bff4eb57' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ceb2ef67-988c-40c0-861f-c09b9cc1d7f6' class='xr-var-data-in' type='checkbox'><label for='data-ceb2ef67-988c-40c0-861f-c09b9cc1d7f6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>YC XC</dd><dt><span>long_name :</span></dt><dd>cell area</dd><dt><span>units :</span></dt><dd>m2</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Zl</span></div><div class='xr-var-dims'>(Zl)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 -10.0 ... -5.244e+03 -5.678e+03</div><input id='attrs-d91a7a9d-af7b-4448-b186-b57f2eb530b0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d91a7a9d-af7b-4448-b186-b57f2eb530b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2b543701-e3b0-4494-9b4f-3c81a4893918' class='xr-var-data-in' type='checkbox'><label for='data-2b543701-e3b0-4494-9b4f-3c81a4893918' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>vertical coordinate of upper cell interface</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([    0.  ,   -10.  ,   -20.  ,   -30.  ,   -40.  ,   -50.  ,   -60.  ,
         -70.  ,   -80.01,   -90.04,  -100.15,  -110.47,  -121.27,  -133.03,
        -146.45,  -162.49,  -182.31,  -207.16,  -238.26,  -276.68,  -323.18,
        -378.18,  -441.68,  -513.26,  -592.16,  -677.31,  -767.49,  -861.45,
        -958.03, -1056.28, -1155.53, -1255.54, -1356.87, -1461.43, -1572.76,
       -1695.59, -1834.68, -1993.62, -2174.45, -2378.  , -2604.5 , -2854.  ,
       -3126.5 , -3422.  , -3740.5 , -4082.  , -4446.5 , -4834.  , -5244.5 ,
       -5678.  ], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e9fc1c8b-60d0-488b-9244-7360863bbd29' class='xr-section-summary-in' type='checkbox' /><label for='section-e9fc1c8b-60d0-488b-9244-7360863bbd29' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(20)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ADVx_SLT_bar</span></div><div class='xr-var-dims'>(Z, face, Y, Xp1)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-6e39c870-7f39-4fca-a57d-6cfb1647a7ed' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6e39c870-7f39-4fca-a57d-6cfb1647a7ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b538578e-259e-486c-ac4b-2831914b7f99' class='xr-var-data-in' type='checkbox'><label for='data-b538578e-259e-486c-ac4b-2831914b7f99' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ADVy_SLT_bar</span></div><div class='xr-var-dims'>(Z, face, Yp1, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-f45013c2-3868-415c-957b-d78075f8ab08' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f45013c2-3868-415c-957b-d78075f8ab08' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5b4b2a7f-edf8-4b1b-82c2-2204e91d8c0f' class='xr-var-data-in' type='checkbox'><label for='data-5b4b2a7f-edf8-4b1b-82c2-2204e91d8c0f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ADVz_SLT_bar</span></div><div class='xr-var-dims'>(Zl, face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-d9430e88-4643-48d2-9e39-16df10e7f733' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d9430e88-4643-48d2-9e39-16df10e7f733' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-87626cbb-c75a-4b62-afc6-fd7f6ce89a6e' class='xr-var-data-in' type='checkbox'><label for='data-87626cbb-c75a-4b62-afc6-fd7f6ce89a6e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DFx_SLT_bar</span></div><div class='xr-var-dims'>(Z, face, Y, Xp1)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-6a67422f-ccdd-459e-8e3c-3de3e14dae25' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6a67422f-ccdd-459e-8e3c-3de3e14dae25' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-999f7b3f-9616-41f2-981e-d22cea08f6b1' class='xr-var-data-in' type='checkbox'><label for='data-999f7b3f-9616-41f2-981e-d22cea08f6b1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DFy_SLT_bar</span></div><div class='xr-var-dims'>(Z, face, Yp1, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-1c798b30-a614-47a4-b5ed-ef10401c29d8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1c798b30-a614-47a4-b5ed-ef10401c29d8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a61b1dee-7cd7-438a-9014-d128470cef2d' class='xr-var-data-in' type='checkbox'><label for='data-a61b1dee-7cd7-438a-9014-d128470cef2d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DFz_SLT_bar</span></div><div class='xr-var-dims'>(Zl, face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-a146c656-025e-477a-ac38-c20b68d547da' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a146c656-025e-477a-ac38-c20b68d547da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb76d29e-699e-4bcc-80ca-4eef6043fc7a' class='xr-var-data-in' type='checkbox'><label for='data-eb76d29e-699e-4bcc-80ca-4eef6043fc7a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>S_bar</span></div><div class='xr-var-dims'>(Z, face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-4ce0ac95-fcea-4421-9902-00e0399ae2f9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4ce0ac95-fcea-4421-9902-00e0399ae2f9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-90d624dd-cda0-4808-93fb-5220c25294ee' class='xr-var-data-in' type='checkbox'><label for='data-90d624dd-cda0-4808-93fb-5220c25294ee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>T_bar</span></div><div class='xr-var-dims'>(Z, face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-3a886aa5-b354-4dc8-9c59-07d91121c4f8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3a886aa5-b354-4dc8-9c59-07d91121c4f8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92558953-7e9b-4020-b356-8ca8b95dd95a' class='xr-var-data-in' type='checkbox'><label for='data-92558953-7e9b-4020-b356-8ca8b95dd95a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dxC</span></div><div class='xr-var-dims'>(face, Y, Xp1)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-3c429caa-c6b7-4120-8a39-0af758140339' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3c429caa-c6b7-4120-8a39-0af758140339' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5b2c603a-0641-402e-a759-80b0a25e2036' class='xr-var-data-in' type='checkbox'><label for='data-5b2c603a-0641-402e-a759-80b0a25e2036' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>YC XG</dd><dt><span>long_name :</span></dt><dd>cell x size</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dxG</span></div><div class='xr-var-dims'>(face, Yp1, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-dddcd75b-50e2-4103-bf6e-6ec2b8901654' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dddcd75b-50e2-4103-bf6e-6ec2b8901654' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-362efe2b-184f-43af-95fa-97469a0fcad8' class='xr-var-data-in' type='checkbox'><label for='data-362efe2b-184f-43af-95fa-97469a0fcad8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>YG XC</dd><dt><span>long_name :</span></dt><dd>cell x size</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dyC</span></div><div class='xr-var-dims'>(face, Yp1, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-7241667a-8d5a-43b5-a306-4ec51757a4cb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7241667a-8d5a-43b5-a306-4ec51757a4cb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc344eef-4e13-4b61-aba0-d5398a379d1d' class='xr-var-data-in' type='checkbox'><label for='data-fc344eef-4e13-4b61-aba0-d5398a379d1d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>YG XC</dd><dt><span>long_name :</span></dt><dd>cell y size</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dyG</span></div><div class='xr-var-dims'>(face, Y, Xp1)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-03e84492-f705-407d-a0c8-aefb8344f81f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-03e84492-f705-407d-a0c8-aefb8344f81f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b7657840-2b80-4c32-a94c-c8f20f7816fa' class='xr-var-data-in' type='checkbox'><label for='data-b7657840-2b80-4c32-a94c-c8f20f7816fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>YC XG</dd><dt><span>long_name :</span></dt><dd>cell y size</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 411.33 kiB </td>
                        <td> 102.83 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 90, 90) </td>
                        <td> (13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 4 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="60" x2="33" y2="83" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.83690725543417,23.836907255434173 33.83690725543417,143.83690725543417 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="70" y1="0" x2="93" y2="23" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.83690725543417,23.836907255434173 33.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="83" x2="153" y2="83" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="93" y1="23" x2="93" y2="143" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.83690725543417,23.836907255434173 153.83690725543417,23.836907255434173 153.83690725543417,143.83690725543417 33.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.83690725543417" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="173.83690725543417" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.83690725543417,83.83690725543417)">90</text>
  <text x="11.918453627717085" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.918453627717085,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>forcFW_bar</span></div><div class='xr-var-dims'>(Z, face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-8734d192-602f-4144-8189-21fff575fe9a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8734d192-602f-4144-8189-21fff575fe9a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89cfc7fa-f37f-4646-b7b8-0cc1d8bacf9f' class='xr-var-data-in' type='checkbox'><label for='data-89cfc7fa-f37f-4646-b7b8-0cc1d8bacf9f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>forcS_bar</span></div><div class='xr-var-dims'>(Z, face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-bb2e53ec-f2b7-44eb-b59e-d48d5401139a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bb2e53ec-f2b7-44eb-b59e-d48d5401139a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9e0ad99f-0c8c-4244-a231-54ff0c098fff' class='xr-var-data-in' type='checkbox'><label for='data-9e0ad99f-0c8c-4244-a231-54ff0c098fff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spdivup_bar</span></div><div class='xr-var-dims'>(Z, face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-5d58d876-ca7b-46e8-9647-194fde442e0b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5d58d876-ca7b-46e8-9647-194fde442e0b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e19e0d08-2bc9-4264-9c63-66d254ecc180' class='xr-var-data-in' type='checkbox'><label for='data-e19e0d08-2bc9-4264-9c63-66d254ecc180' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tendSln_bar</span></div><div class='xr-var-dims'>(Z, face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-38c1e600-532c-4c6a-838d-c9d1e1239fef' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-38c1e600-532c-4c6a-838d-c9d1e1239fef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a118ac27-1bf0-4fa9-91ac-a97960eb0d8b' class='xr-var-data-in' type='checkbox'><label for='data-a118ac27-1bf0-4fa9-91ac-a97960eb0d8b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u_bar</span></div><div class='xr-var-dims'>(Z, face, Y, Xp1)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-2593ae98-523f-4e67-a0b0-5fcf2b87cb1f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2593ae98-523f-4e67-a0b0-5fcf2b87cb1f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e70cb49-e116-4a06-86e5-7ebd66b6f313' class='xr-var-data-in' type='checkbox'><label for='data-4e70cb49-e116-4a06-86e5-7ebd66b6f313' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v_bar</span></div><div class='xr-var-dims'>(Z, face, Yp1, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-075d1fd7-20e0-4888-96f4-f2b1d704c47e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-075d1fd7-20e0-4888-96f4-f2b1d704c47e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f8231aca-6b71-46a2-acdb-489a3aa4e6e3' class='xr-var-data-in' type='checkbox'><label for='data-f8231aca-6b71-46a2-acdb-489a3aa4e6e3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>w_bar</span></div><div class='xr-var-dims'>(Zl, face, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 13, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-6cc681d0-e10f-49a4-a63b-272a91fd5a38' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6cc681d0-e10f-49a4-a63b-272a91fd5a38' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f3270c65-5c0d-40d9-84ea-e3d9a955a85e' class='xr-var-data-in' type='checkbox'><label for='data-f3270c65-5c0d-40d9-84ea-e3d9a955a85e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (50, 13, 90, 90) </td>
                        <td> (10, 13, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="465" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="66" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="66" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 66.66666666666667,0.0 66.66666666666667,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="33.333333333333336" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="86.66666666666667" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,86.66666666666667,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="136" y1="60" x2="159" y2="83" />
  <line x1="136" y1="120" x2="159" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="136" y2="120" style="stroke-width:2" />
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 159.83690725543417,23.836907255434173 159.83690725543417,143.83690725543417 136.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="136" y1="0" x2="256" y2="0" style="stroke-width:2" />
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="136" y1="0" x2="159" y2="23" style="stroke-width:2" />
  <line x1="196" y1="0" x2="219" y2="23" />
  <line x1="256" y1="0" x2="279" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="136.0,0.0 256.0,0.0 279.8369072554342,23.836907255434173 159.83690725543417,23.836907255434173" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="159" y1="23" x2="279" y2="23" style="stroke-width:2" />
  <line x1="159" y1="83" x2="279" y2="83" />
  <line x1="159" y1="143" x2="279" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="159" y1="23" x2="159" y2="143" style="stroke-width:2" />
  <line x1="219" y1="23" x2="219" y2="143" />
  <line x1="279" y1="23" x2="279" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="159.83690725543417,23.836907255434173 279.8369072554342,23.836907255434173 279.8369072554342,143.83690725543417 159.83690725543417,143.83690725543417" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="219.8369072554342" y="163.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="299.8369072554342" y="83.83690725543417" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,299.8369072554342,83.83690725543417)">90</text>
  <text x="137.9184536277171" y="151.9184536277171" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,137.9184536277171,151.9184536277171)">13</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Vol</span></div><div class='xr-var-dims'>(face, Z, Y, X)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13, 10, 45, 45), meta=np.ndarray&gt;</div><input id='attrs-076ac5fe-68f5-400d-a2eb-e259c3579f74' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-076ac5fe-68f5-400d-a2eb-e259c3579f74' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-31e7e5f8-7b56-49ec-9687-5f241963fb49' class='xr-var-data-in' type='checkbox'><label for='data-31e7e5f8-7b56-49ec-9687-5f241963fb49' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>coordinate :</span></dt><dd>YC XC</dd><dt><span>long_name :</span></dt><dd>vertical fraction of open cell</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 20.08 MiB </td>
                        <td> 1.00 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13, 50, 90, 90) </td>
                        <td> (13, 10, 45, 45) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 20 chunks in 13 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="429" height="209" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="40" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="40" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="40" y1="0" x2="40" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 40.522742334238096,0.0 40.522742334238096,25.924160051965714 0.0,25.924160051965714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="20.261371167119048" y="45.924160051965714" font-size="1.0rem" font-weight="100" text-anchor="middle" >13</text>
  <text x="60.522742334238096" y="12.962080025982857" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,60.522742334238096,12.962080025982857)">1</text>


  <!-- Horizontal lines -->
  <line x1="110" y1="0" x2="149" y2="39" style="stroke-width:2" />
  <line x1="110" y1="60" x2="149" y2="99" />
  <line x1="110" y1="120" x2="149" y2="159" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="110" y1="0" x2="110" y2="120" style="stroke-width:2" />
  <line x1="117" y1="7" x2="117" y2="127" />
  <line x1="125" y1="15" x2="125" y2="135" />
  <line x1="133" y1="23" x2="133" y2="143" />
  <line x1="141" y1="31" x2="141" y2="151" />
  <line x1="149" y1="39" x2="149" y2="159" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="110.0,0.0 149.2156862745098,39.21568627450981 149.2156862745098,159.2156862745098 110.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="110" y1="0" x2="230" y2="0" style="stroke-width:2" />
  <line x1="117" y1="7" x2="237" y2="7" />
  <line x1="125" y1="15" x2="245" y2="15" />
  <line x1="133" y1="23" x2="253" y2="23" />
  <line x1="141" y1="31" x2="261" y2="31" />
  <line x1="149" y1="39" x2="269" y2="39" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="110" y1="0" x2="149" y2="39" style="stroke-width:2" />
  <line x1="170" y1="0" x2="209" y2="39" />
  <line x1="230" y1="0" x2="269" y2="39" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="110.0,0.0 230.0,0.0 269.21568627450984,39.21568627450981 149.2156862745098,39.21568627450981" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="149" y1="39" x2="269" y2="39" style="stroke-width:2" />
  <line x1="149" y1="99" x2="269" y2="99" />
  <line x1="149" y1="159" x2="269" y2="159" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="149" y1="39" x2="149" y2="159" style="stroke-width:2" />
  <line x1="209" y1="39" x2="209" y2="159" />
  <line x1="269" y1="39" x2="269" y2="159" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="149.2156862745098,39.21568627450981 269.21568627450984,39.21568627450981 269.21568627450984,159.2156862745098 149.2156862745098,159.2156862745098" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="209.21568627450984" y="179.2156862745098" font-size="1.0rem" font-weight="100" text-anchor="middle" >90</text>
  <text x="289.21568627450984" y="99.2156862745098" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,289.21568627450984,99.2156862745098)">90</text>
  <text x="119.60784313725492" y="159.60784313725492" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,119.60784313725492,159.60784313725492)">50</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # ds_bar = ds_bar[list(ds_bar.data_vars)]</span>
<span class="c1"># ds_bar[&#39;spdivup_bar&#39;] = -ds_bar.spgradup_bar</span>
<span class="c1"># to_output = []</span>
<span class="c1"># for var in ds_bar.data_vars:</span>
<span class="c1">#     if var not in [&#39;Vol&#39;,&#39;spgradup_bar&#39;]:</span>
<span class="c1">#         to_output.append(var)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ds_bar[to_output].to_zarr(&#39;~/Temporary/wenrui/scratch/eul_bud_basic.zarr&#39;)</span>
</pre></div>
</div>
</div>
</div>
<p>This dataset has the required variables to calculate the mean salinity budget, as well as some ECCOv4r4 grid variables. These are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\textbf{S_bar --&gt; time-mean salinity [PSU]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textbf{T_bar --&gt; time-mean potential temperature [Â°C]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textbf{u_bar, v_bar, w_bar --&gt; time-mean total velocity [m s\)</span>^{-1}<span class="math notranslate nohighlight">\(]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textbf{ADVx_SLT_bar (etc.) --&gt; time-mean advective flux of salinity [PSU m\)</span>^{3}<span class="math notranslate nohighlight">\( s\)</span>^{-1}<span class="math notranslate nohighlight">\(]}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textbf{DFx_SLT_bar (etc.) --&gt; time-mean diffusive flux of salinity [PSU m\)</span>^{3}<span class="math notranslate nohighlight">\( s\)</span>^{-1}<span class="math notranslate nohighlight">\(]}\)</span></p></li>
<li><p>forcS_bar â€“&gt; time-mean salt forcing [PSU s<span class="math notranslate nohighlight">\(^{-1}\)</span>]</p></li>
<li><p>forcFW_bar â€“&gt; time-mean freshwater forcing [PSU s<span class="math notranslate nohighlight">\(^{-1}\)</span>]</p></li>
<li><p>tendSln_bar â€“&gt; time-mean salinity tendency [PSU s<span class="math notranslate nohighlight">\(^{-1}\)</span>]</p></li>
<li><p>spgradup_bar â€“&gt; <span class="math notranslate nohighlight">\(\overline{S'\nabla u'}\)</span> [PSU s<span class="math notranslate nohighlight">\(^{-1}\)</span>]</p></li>
</ul>
<p>The terms in bold are available directly from ECCOv4r4 model output. The other terms require a bit of calculation, but that is excluded from this notebook for brevity. Interested readers are directed to <a class="reference external" href="https://dspace.mit.edu/handle/1721.1/111094?show=full">Piecuch 2017</a> for an instructive guide on the calculation of budget terms in ECCOv4r4.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grid object</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">sdeb</span><span class="o">.</span><span class="n">create_ecco_grid</span><span class="p">(</span><span class="n">ds_bar</span><span class="p">,</span><span class="n">for_outer</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-the-wall-salinity">
<h2>1. Calculate the wall salinity<a class="headerlink" href="#calculate-the-wall-salinity" title="Permalink to this heading">#</a></h2>
<p>The first step to calculating a salinity budget is to calculate the â€œwall salinityâ€. This involves interpolating the model salinity onto the grid walls so that salinity and velocity can be stored at the same point on the model grid.</p>
<p>Before we do that, we will create a <code class="docutils literal notranslate"><span class="pre">Topology</span></code> object using a seaduck built-in function, which helps us navigate the complex tile connections of ECCO. For more information on topology objects, check out the seaduck documentation <a class="reference external" href="https://macekuailv.github.io/seaduck/notebook/topology_tutorial.html">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Topology object</span>
<span class="n">tp</span> <span class="o">=</span> <span class="n">sd</span><span class="o">.</span><span class="n">Topology</span><span class="p">(</span><span class="n">ds_bar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ----------------------------------------------</span>
<span class="c1"># Create wall salinity (uses seaduck functions)</span>
<span class="c1"># ----------------------------------------------</span>

<span class="n">lm</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># The extra margin on the left side</span>
<span class="n">rm</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># and that on the right side</span>

<span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">dxG</span><span class="p">)</span>
<span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">dyC</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds_bar</span>

<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">w_bar</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">S_bar</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">maskC</span><span class="o">!=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">sz</span> <span class="o">=</span> <span class="n">sdeb</span><span class="o">.</span><span class="n">third_order_upwind_z</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">u_bar</span><span class="p">)</span>
<span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">):</span>
    <span class="n">xbuffer</span> <span class="o">=</span> <span class="n">sdeb</span><span class="o">.</span><span class="n">buffer_x_withface</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">face</span><span class="p">,</span><span class="n">lm</span><span class="p">,</span><span class="n">rm</span><span class="p">,</span><span class="n">tp</span><span class="p">)</span>
    <span class="c1"># uu = u[...,face,:,:]</span>
    <span class="c1"># dxdx = dx[face]</span>
    <span class="n">u_cfl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="n">face</span><span class="p">,:,:]</span><span class="o">/</span><span class="n">dx</span><span class="p">[</span><span class="n">face</span><span class="p">])</span>

    <span class="n">sx</span><span class="p">[:,</span><span class="n">face</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">sdeb</span><span class="o">.</span><span class="n">third_order_DST_x</span><span class="p">(</span><span class="n">xbuffer</span><span class="p">,</span><span class="n">u_cfl</span><span class="p">)</span>


<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">v_bar</span><span class="p">)</span>
<span class="n">sy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">):</span>
    <span class="n">u_cfl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="n">face</span><span class="p">,:,:]</span><span class="o">/</span><span class="n">dy</span><span class="p">[</span><span class="n">face</span><span class="p">])</span>
    <span class="n">ybuffer</span> <span class="o">=</span> <span class="n">sdeb</span><span class="o">.</span><span class="n">buffer_y_withface</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">face</span><span class="p">,</span><span class="n">lm</span><span class="p">,</span><span class="n">rm</span><span class="p">,</span><span class="n">tp</span><span class="p">)</span>

    <span class="n">sy</span><span class="p">[:,</span><span class="n">face</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">sdeb</span><span class="o">.</span><span class="n">third_order_DST_y</span><span class="p">(</span><span class="n">ybuffer</span><span class="p">,</span><span class="n">u_cfl</span><span class="p">)</span>

<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;sx_bar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">sx</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;face&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Xp1&#39;</span><span class="p">))</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;sy_bar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;face&#39;</span><span class="p">,</span><span class="s1">&#39;Yp1&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;sz_bar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">sz</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Zl&#39;</span><span class="p">,</span><span class="s1">&#39;face&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Now our dataset also contains the time-mean salinity stored on the x, y and z faces of the model grid. This will be required to calculate the advection term of the salinity budget.</p>
</section>
<section id="calculating-the-salinity-budget">
<h2>2. Calculating the Salinity Budget<a class="headerlink" href="#calculating-the-salinity-budget" title="Permalink to this heading">#</a></h2>
<p>Now, onto the main event: finding the salinity budget.</p>
<p>The time-mean salinity budget can be expressed as:</p>
<div class="math notranslate nohighlight">
\[\Large\frac{\partial{\overline{S}}}{\partial{t}} =  -\overline{u}\cdot\nabla{\overline{S}} - \overline{u'\cdot\nabla s'} - \nabla\cdot{\overline{DIF}_{x,y,z}} + \overline{F}_{FW} + \overline{F}_{S}\]</div>
<p>where <span class="math notranslate nohighlight">\(\overline{u'\cdot\nabla s'}\)</span> is calculated by:</p>
<div class="math notranslate nohighlight">
\[
\overline{u'\cdot\nabla s'} = \left(\nabla\cdot{\overline{ADV}_{x,y,z}} - \nabla\cdot{(\overline{u}\overline{S})} - \overline{S'\nabla u'} \right)
\]</div>
<p>Terms are defined as:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\frac{\partial{\overline{S}}}{\partial{t}}\)</span> â€“&gt; Salinity tendency</p></li>
<li><p><span class="math notranslate nohighlight">\(\left( -\overline{u}\cdot\nabla{\overline{S}} - \overline{u'\cdot\nabla s'} \right)\)</span> â€“&gt; Advection of salinity</p></li>
<li><p><span class="math notranslate nohighlight">\(\nabla{\overline{DIF}_{x,y,z}}\)</span> â€“&gt; Diffusion of salinity</p></li>
<li><p><span class="math notranslate nohighlight">\(\overline{F}_{FW}\)</span> â€“&gt; Freshwater forcing</p></li>
<li><p><span class="math notranslate nohighlight">\(\overline{F}_{S}\)</span> â€“&gt; Salt forcing</p></li>
</ul>
<p>All terms but the advection of salinity are stored in the dataset â€˜ds_barâ€™. We must calculate the advection of salinity term, which we will do one term at a time below.</p>
<p>First, we define a function to calculate volume transport from velocity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---------------------------</span>
<span class="c1">#Â Define transport function</span>
<span class="c1"># ---------------------------</span>

<span class="k">def</span><span class="w"> </span><span class="nf">vel_to_trans</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">u</span> <span class="o">*</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">drF</span> <span class="o">*</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">dyG</span><span class="p">,</span>
        <span class="n">v</span> <span class="o">*</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">drF</span> <span class="o">*</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">dxG</span><span class="p">,</span>
        <span class="n">w</span> <span class="o">*</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">rA</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now calculate the volume/salinity fluxes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate volume transport</span>
<span class="n">ut</span><span class="p">,</span> <span class="n">vt</span><span class="p">,</span> <span class="n">wt</span> <span class="o">=</span> <span class="n">vel_to_trans</span><span class="p">(</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">u_bar</span><span class="p">,</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">v_bar</span><span class="p">,</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">w_bar</span><span class="p">)</span>

<span class="c1"># Calculate each component</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;ubarsbar_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ut</span> <span class="o">*</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">sx_bar</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;ubarsbar_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vt</span> <span class="o">*</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">sy_bar</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;ubarsbar_z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">wt</span> <span class="o">*</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">sz_bar</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate each component</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;utrans&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;vtrans&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;wtrans&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wt</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;wtrans&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;ADV_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">ADVx_SLT_bar</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;ADV_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">ADVy_SLT_bar</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;ADV_z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">ADVz_SLT_bar</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;DIF_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">DFx_SLT_bar</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;DIF_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">DFy_SLT_bar</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">ds_bar</span><span class="p">[</span><span class="s1">&#39;DIF_z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">DFz_SLT_bar</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>To calculate the divergence of the fluxes, we first create a <code class="docutils literal notranslate"><span class="pre">OceData</span></code> object</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tub</span> <span class="o">=</span> <span class="n">sd</span><span class="o">.</span><span class="n">OceData</span><span class="p">(</span><span class="n">ds_bar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="calculate-nabla-cdot-overline-u-overline-s">
<h3>Calculate <span class="math notranslate nohighlight">\(\nabla\cdot{(\overline{u}\overline{S})}\)</span><a class="headerlink" href="#calculate-nabla-cdot-overline-u-overline-s" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------</span>
<span class="c1">#Â Calculate div (uS)</span>
<span class="c1"># -------------------------------</span>
<span class="n">divus</span> <span class="o">=</span> <span class="n">sdeb</span><span class="o">.</span><span class="n">total_div</span><span class="p">(</span><span class="n">tub</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;ubarsbar_x&#39;</span><span class="p">,</span> <span class="s1">&#39;ubarsbar_y&#39;</span><span class="p">,</span> <span class="s1">&#39;ubarsbar_z&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>###Â Calculate <span class="math notranslate nohighlight">\(\overline{S}\cdot\nabla{\overline{u}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------</span>
<span class="c1">#Â Calculate div (uS)</span>
<span class="c1"># -------------------------------</span>
<span class="n">divu</span> <span class="o">=</span> <span class="n">sdeb</span><span class="o">.</span><span class="n">total_div</span><span class="p">(</span><span class="n">tub</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;utrans&#39;</span><span class="p">,</span> <span class="s1">&#39;vtrans&#39;</span><span class="p">,</span> <span class="s1">&#39;wtrans&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Multiply by mean salinity</span>
<span class="c1"># -------------------------------</span>
<span class="c1">#Â Calculate the term -- S div (u)</span>
<span class="c1"># -------------------------------</span>
<span class="n">sdivu</span> <span class="o">=</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">S_bar</span> <span class="o">*</span> <span class="n">divu</span>
</pre></div>
</div>
</div>
</div>
<p>Now the above terms can be combined to give the required <span class="math notranslate nohighlight">\(\overline{u}\cdot\nabla{\overline{S}}\)</span> term:</p>
<p>###Â Calculate <span class="math notranslate nohighlight">\(\large\overline{u}\cdot\nabla{\overline{S}} = \nabla\cdot{(\overline{u}\overline{S})} - \overline{S}\cdot\nabla{\overline{u}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------</span>
<span class="c1">#Â Calculate u dot grad(S)</span>
<span class="c1"># -------------------------------</span>
<span class="n">ugrads</span> <span class="o">=</span> <span class="n">divus</span> <span class="o">-</span> <span class="n">sdivu</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-the-divergence-of-adv-and-dif-terms">
<h3>Calculate the divergence of ADV and DIF terms<a class="headerlink" href="#calculate-the-divergence-of-adv-and-dif-terms" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------</span>
<span class="c1">#Â Calculate div(ADV)</span>
<span class="c1"># -------------------------------</span>

<span class="n">divADV</span> <span class="o">=</span> <span class="n">sdeb</span><span class="o">.</span><span class="n">total_div</span><span class="p">(</span><span class="n">tub</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;ADV_x&#39;</span><span class="p">,</span> <span class="s1">&#39;ADV_y&#39;</span><span class="p">,</span> <span class="s1">&#39;ADV_z&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------</span>
<span class="c1">#Â Calculate -div(DIF)</span>
<span class="c1"># -------------------------------</span>

<span class="n">dif_h</span> <span class="o">=</span> <span class="o">-</span><span class="n">sdeb</span><span class="o">.</span><span class="n">hor_div</span><span class="p">(</span><span class="n">tub</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;DIF_x&#39;</span><span class="p">,</span> <span class="s1">&#39;DIF_y&#39;</span><span class="p">)</span>
<span class="n">dif_v</span> <span class="o">=</span> <span class="o">-</span><span class="n">sdeb</span><span class="o">.</span><span class="n">ver_div</span><span class="p">(</span><span class="n">tub</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;DIF_z&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="check-the-budget-closure">
<h3>3. Check the budget closure<a class="headerlink" href="#check-the-budget-closure" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------------------------------</span>
<span class="c1"># Calculate the advection term</span>
<span class="c1"># ------------------------------</span>

<span class="n">adv</span> <span class="o">=</span> <span class="n">ugrads</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------------------------------</span>
<span class="c1"># Calculate the eddy transport term</span>
<span class="c1"># ------------------------------</span>

<span class="n">neg_upgradsp_bar</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">divADV</span> <span class="o">-</span> <span class="n">divus</span> <span class="o">-</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">spdivup_bar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------------------------------</span>
<span class="c1"># Calculate the forcing term</span>
<span class="c1"># ------------------------------</span>

<span class="n">forc</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">forcFW_bar</span><span class="p">)</span> <span class="o">+</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">forcS_bar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If we have done this correctly, then the LHS - RHS of the budget equation should equal 0 (to machine precision). Letâ€™s check!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------------------------------</span>
<span class="c1">#Â Check that the budget closes</span>
<span class="c1"># ------------------------------</span>

<span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_bar</span><span class="o">.</span><span class="n">tendSln_bar</span> <span class="o">+</span> <span class="n">adv</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">forc</span> <span class="o">+</span> <span class="n">neg_upgradsp_bar</span> <span class="o">+</span> <span class="n">dif_h</span> <span class="o">+</span> <span class="n">dif_v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Â ----------------------------------------------</span>
<span class="c1"># Plot the residuals (around the UK and Europe)</span>
<span class="c1">#Â ----------------------------------------------</span>

<span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7f656c7f50d0&gt;
</pre></div>
</div>
<img alt="../_images/5562ad40ad75c023f5802ff4dbcccb37abdd9a27ae80156462d51c3bbdede589.png" src="../_images/5562ad40ad75c023f5802ff4dbcccb37abdd9a27ae80156462d51c3bbdede589.png" />
</div>
</div>
<p>Success!</p>
<p>Now we can use these eulerian budget terms to calculate the Lagrangian budget.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[[</span><span class="s1">&#39;sx_bar&#39;</span><span class="p">,</span><span class="s1">&#39;sy_bar&#39;</span><span class="p">,</span><span class="s1">&#39;sz_bar&#39;</span><span class="p">,</span><span class="s1">&#39;u_bar&#39;</span><span class="p">,</span><span class="s1">&#39;v_bar&#39;</span><span class="p">,</span><span class="s1">&#39;w_bar&#39;</span><span class="p">,</span><span class="s1">&#39;S_bar&#39;</span><span class="p">,</span><span class="s1">&#39;T_bar&#39;</span><span class="p">,</span><span class="s1">&#39;dxG&#39;</span><span class="p">,</span><span class="s1">&#39;dyG&#39;</span><span class="p">]]</span>
<span class="n">out</span><span class="p">[</span><span class="s1">&#39;neg_upgradsp_bar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">neg_upgradsp_bar</span>
<span class="n">out</span><span class="p">[</span><span class="s1">&#39;forc_s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">forc</span>
<span class="n">out</span><span class="p">[</span><span class="s1">&#39;dif_h&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dif_h</span>
<span class="n">out</span><span class="p">[</span><span class="s1">&#39;dif_v&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dif_v</span>
<span class="n">out</span><span class="p">[</span><span class="s1">&#39;conv_us&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">divus</span>
<span class="n">out</span><span class="p">[</span><span class="s1">&#39;tend_s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">tendSln_bar</span>
<span class="n">out</span><span class="o">.</span><span class="n">to_zarr</span><span class="p">(</span><span class="s1">&#39;lag_budg.zarr&#39;</span><span class="p">,</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span> <span class="n">line</span> <span class="mi">8</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;conv_us&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">divus</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">out</span><span class="p">[</span><span class="s1">&#39;tend_s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_bar</span><span class="o">.</span><span class="n">tendSln_bar</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="n">out</span><span class="o">.</span><span class="n">to_zarr</span><span class="p">(</span><span class="s1">&#39;lag_budg.zarr&#39;</span><span class="p">,</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/xarray/core/dataset.py:2390,</span> in <span class="ni">Dataset.to_zarr</span><span class="nt">(self, store, chunk_store, mode, synchronizer, group, encoding, compute, consolidated, append_dim, region, safe_chunks, align_chunks, storage_options, zarr_version, zarr_format, write_empty_chunks, chunkmanager_store_kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2207</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Write dataset contents to a zarr group.</span>
<span class="g g-Whitespace">   </span><span class="mi">2208</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">2209</span><span class="sd"> Zarr chunks are determined in the following way:</span>
<span class="sd">   (...)   2386     The I/O user guide, with more details and examples.</span>
<span class="g g-Whitespace">   </span><span class="mi">2387</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2388</span> <span class="kn">from</span><span class="w"> </span><span class="nn">xarray.backends.writers</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_zarr</span>
<span class="ne">-&gt; </span><span class="mi">2390</span> <span class="k">return</span> <span class="n">to_zarr</span><span class="p">(</span>  <span class="c1"># type: ignore[call-overload,misc]</span>
<span class="g g-Whitespace">   </span><span class="mi">2391</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2392</span>     <span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2393</span>     <span class="n">chunk_store</span><span class="o">=</span><span class="n">chunk_store</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2394</span>     <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2395</span>     <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2396</span>     <span class="n">synchronizer</span><span class="o">=</span><span class="n">synchronizer</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2397</span>     <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2398</span>     <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2399</span>     <span class="n">compute</span><span class="o">=</span><span class="n">compute</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2400</span>     <span class="n">consolidated</span><span class="o">=</span><span class="n">consolidated</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2401</span>     <span class="n">append_dim</span><span class="o">=</span><span class="n">append_dim</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2402</span>     <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2403</span>     <span class="n">safe_chunks</span><span class="o">=</span><span class="n">safe_chunks</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2404</span>     <span class="n">align_chunks</span><span class="o">=</span><span class="n">align_chunks</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2405</span>     <span class="n">zarr_version</span><span class="o">=</span><span class="n">zarr_version</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2406</span>     <span class="n">zarr_format</span><span class="o">=</span><span class="n">zarr_format</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2407</span>     <span class="n">write_empty_chunks</span><span class="o">=</span><span class="n">write_empty_chunks</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2408</span>     <span class="n">chunkmanager_store_kwargs</span><span class="o">=</span><span class="n">chunkmanager_store_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2409</span> <span class="p">)</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/xarray/backends/writers.py:797,</span> in <span class="ni">to_zarr</span><span class="nt">(dataset, store, chunk_store, mode, synchronizer, group, encoding, compute, consolidated, append_dim, region, safe_chunks, align_chunks, storage_options, zarr_version, zarr_format, write_empty_chunks, chunkmanager_store_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">795</span> <span class="c1"># TODO: figure out how to properly handle unlimited_dims</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">797</span>     <span class="n">dump_to_store</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">zstore</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span>     <span class="n">writes</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sync</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">799</span>         <span class="n">compute</span><span class="o">=</span><span class="n">compute</span><span class="p">,</span> <span class="n">chunkmanager_store_kwargs</span><span class="o">=</span><span class="n">chunkmanager_store_kwargs</span>
<span class="g g-Whitespace">    </span><span class="mi">800</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">801</span> <span class="k">finally</span><span class="p">:</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/xarray/backends/writers.py:491,</span> in <span class="ni">dump_to_store</span><span class="nt">(dataset, store, writer, encoder, encoding, unlimited_dims)</span>
<span class="g g-Whitespace">    </span><span class="mi">488</span> <span class="k">if</span> <span class="n">encoder</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">489</span>     <span class="n">variables</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">491</span> <span class="n">store</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">check_encoding</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">unlimited_dims</span><span class="o">=</span><span class="n">unlimited_dims</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/xarray/backends/zarr.py:1064,</span> in <span class="ni">ZarrStore.store</span><span class="nt">(self, variables, attributes, check_encoding_set, writer, unlimited_dims)</span>
<span class="g g-Whitespace">   </span><span class="mi">1061</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1062</span>     <span class="n">variables_to_set</span> <span class="o">=</span> <span class="n">variables_encoded</span>
<span class="ne">-&gt; </span><span class="mi">1064</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_variables</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1065</span>     <span class="n">variables_to_set</span><span class="p">,</span> <span class="n">check_encoding_set</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">unlimited_dims</span><span class="o">=</span><span class="n">unlimited_dims</span>
<span class="g g-Whitespace">   </span><span class="mi">1066</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1067</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_consolidate_on_close</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1068</span>     <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/xarray/backends/zarr.py:1290,</span> in <span class="ni">ZarrStore.set_variables</span><span class="nt">(self, variables, check_encoding_set, writer, unlimited_dims)</span>
<span class="g g-Whitespace">   </span><span class="mi">1286</span>         <span class="n">encoded_attrs</span><span class="p">[</span><span class="n">DIMENSION_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="n">dims</span>
<span class="g g-Whitespace">   </span><span class="mi">1288</span>     <span class="n">encoding</span><span class="p">[</span><span class="s2">&quot;overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1290</span>     <span class="n">zarr_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_new_array</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1291</span>         <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1292</span>         <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1293</span>         <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1294</span>         <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1295</span>         <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1296</span>         <span class="n">attrs</span><span class="o">=</span><span class="n">encoded_attrs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1297</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1299</span> <span class="n">writer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">zarr_array</span><span class="p">,</span> <span class="n">region</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/xarray/backends/zarr.py:1141,</span> in <span class="ni">ZarrStore._create_new_array</span><span class="nt">(self, name, shape, dtype, fill_value, encoding, attrs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1138</span>         <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">encoding</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1139</span>             <span class="n">encoding</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoding</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1141</span> <span class="n">zarr_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zarr_group</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1142</span>     <span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1143</span>     <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1144</span>     <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1145</span>     <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1146</span>     <span class="o">**</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1147</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1148</span> <span class="n">zarr_array</span> <span class="o">=</span> <span class="n">_put_attrs</span><span class="p">(</span><span class="n">zarr_array</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1149</span> <span class="k">return</span> <span class="n">zarr_array</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/zarr/core/group.py:2567,</span> in <span class="ni">Group.create</span><span class="nt">(self, name, shape, dtype, data, chunks, shards, filters, compressors, compressor, serializer, fill_value, order, attributes, chunk_key_encoding, dimension_names, storage_options, overwrite, config, write_data)</span>
<span class="g g-Whitespace">   </span><span class="mi">2445</span> <span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2446</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2447</span>     <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>   <span class="mi">2466</span>     <span class="n">write_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2467</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyArray</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2468</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Create an array within this group.</span>
<span class="g g-Whitespace">   </span><span class="mi">2469</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">2470</span><span class="sd">     This method lightly wraps [`zarr.core.array.create_array`][].</span>
<span class="sd">   (...)   2565     AsyncArray</span>
<span class="g g-Whitespace">   </span><span class="mi">2566</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">2567</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2568</span>         <span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2569</span>         <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2570</span>         <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2571</span>         <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2572</span>         <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2573</span>         <span class="n">shards</span><span class="o">=</span><span class="n">shards</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2574</span>         <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2575</span>         <span class="n">compressors</span><span class="o">=</span><span class="n">compressors</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2576</span>         <span class="n">compressor</span><span class="o">=</span><span class="n">compressor</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2577</span>         <span class="n">serializer</span><span class="o">=</span><span class="n">serializer</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2578</span>         <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2579</span>         <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2580</span>         <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2581</span>         <span class="n">chunk_key_encoding</span><span class="o">=</span><span class="n">chunk_key_encoding</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2582</span>         <span class="n">dimension_names</span><span class="o">=</span><span class="n">dimension_names</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2583</span>         <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2584</span>         <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2585</span>         <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2586</span>         <span class="n">write_data</span><span class="o">=</span><span class="n">write_data</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2587</span>     <span class="p">)</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/zarr/core/group.py:2715,</span> in <span class="ni">Group.create_array</span><span class="nt">(self, name, shape, dtype, data, chunks, shards, filters, compressors, compressor, serializer, fill_value, order, attributes, chunk_key_encoding, dimension_names, storage_options, overwrite, config, write_data)</span>
<span class="g g-Whitespace">   </span><span class="mi">2612</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Create an array within this group.</span>
<span class="g g-Whitespace">   </span><span class="mi">2613</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">2614</span><span class="sd"> This method lightly wraps [zarr.core.array.create_array][].</span>
<span class="sd">   (...)   2709 AsyncArray</span>
<span class="g g-Whitespace">   </span><span class="mi">2710</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2711</span> <span class="n">compressors</span> <span class="o">=</span> <span class="n">_parse_deprecated_compressor</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2712</span>     <span class="n">compressor</span><span class="p">,</span> <span class="n">compressors</span><span class="p">,</span> <span class="n">zarr_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">zarr_format</span>
<span class="g g-Whitespace">   </span><span class="mi">2713</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2714</span> <span class="k">return</span> <span class="n">Array</span><span class="p">(</span>
<span class="ne">-&gt; </span><span class="mi">2715</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_sync</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2716</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_async_group</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2717</span>             <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2718</span>             <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2719</span>             <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2720</span>             <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2721</span>             <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2722</span>             <span class="n">shards</span><span class="o">=</span><span class="n">shards</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2723</span>             <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2724</span>             <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2725</span>             <span class="n">chunk_key_encoding</span><span class="o">=</span><span class="n">chunk_key_encoding</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2726</span>             <span class="n">compressors</span><span class="o">=</span><span class="n">compressors</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2727</span>             <span class="n">serializer</span><span class="o">=</span><span class="n">serializer</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2728</span>             <span class="n">dimension_names</span><span class="o">=</span><span class="n">dimension_names</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2729</span>             <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2730</span>             <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2731</span>             <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2732</span>             <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2733</span>             <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2734</span>             <span class="n">write_data</span><span class="o">=</span><span class="n">write_data</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2735</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2736</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2737</span> <span class="p">)</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/zarr/core/sync.py:204,</span> in <span class="ni">SyncMixin._sync</span><span class="nt">(self, coroutine)</span>
<span class="g g-Whitespace">    </span><span class="mi">201</span> <span class="k">def</span><span class="w"> </span><span class="nf">_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coroutine</span><span class="p">:</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">202</span>     <span class="c1"># TODO: refactor this to to take *args and **kwargs and pass those to the method</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span>     <span class="c1"># this should allow us to better type the sync wrapper</span>
<span class="ne">--&gt; </span><span class="mi">204</span>     <span class="k">return</span> <span class="n">sync</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span>         <span class="n">coroutine</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>         <span class="n">timeout</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;async.timeout&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span>     <span class="p">)</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/zarr/core/sync.py:159,</span> in <span class="ni">sync</span><span class="nt">(coro, loop, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span> <span class="n">return_result</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">finished</span><span class="p">))</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_result</span><span class="p">,</span> <span class="ne">BaseException</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">159</span>     <span class="k">raise</span> <span class="n">return_result</span>
<span class="g g-Whitespace">    </span><span class="mi">160</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span>     <span class="k">return</span> <span class="n">return_result</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/zarr/core/sync.py:119,</span> in <span class="ni">_runner</span><span class="nt">(coro)</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span><span class="sd"> Await a coroutine and return the result of running it. If awaiting the coroutine raises an</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span><span class="sd"> exception, the exception will be returned.</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">119</span>     <span class="k">return</span> <span class="k">await</span> <span class="n">coro</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span> <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">121</span>     <span class="k">return</span> <span class="n">ex</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/zarr/core/group.py:1142,</span> in <span class="ni">AsyncGroup.create_array</span><span class="nt">(self, name, shape, dtype, data, chunks, shards, filters, compressors, compressor, serializer, fill_value, order, attributes, chunk_key_encoding, dimension_names, storage_options, overwrite, config, write_data)</span>
<span class="g g-Whitespace">   </span><span class="mi">1041</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Create an array within this group.</span>
<span class="g g-Whitespace">   </span><span class="mi">1042</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1043</span><span class="sd"> This method lightly wraps [zarr.core.array.create_array][].</span>
<span class="sd">   (...)   1137 </span>
<span class="g g-Whitespace">   </span><span class="mi">1138</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1139</span> <span class="n">compressors</span> <span class="o">=</span> <span class="n">_parse_deprecated_compressor</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1140</span>     <span class="n">compressor</span><span class="p">,</span> <span class="n">compressors</span><span class="p">,</span> <span class="n">zarr_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">zarr_format</span>
<span class="g g-Whitespace">   </span><span class="mi">1141</span> <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1142</span> <span class="k">return</span> <span class="k">await</span> <span class="n">create_array</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1143</span>     <span class="n">store</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">store_path</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1144</span>     <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1145</span>     <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1146</span>     <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1147</span>     <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1148</span>     <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1149</span>     <span class="n">shards</span><span class="o">=</span><span class="n">shards</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1150</span>     <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1151</span>     <span class="n">compressors</span><span class="o">=</span><span class="n">compressors</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1152</span>     <span class="n">serializer</span><span class="o">=</span><span class="n">serializer</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1153</span>     <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1154</span>     <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1155</span>     <span class="n">zarr_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">zarr_format</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1156</span>     <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1157</span>     <span class="n">chunk_key_encoding</span><span class="o">=</span><span class="n">chunk_key_encoding</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1158</span>     <span class="n">dimension_names</span><span class="o">=</span><span class="n">dimension_names</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1159</span>     <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1160</span>     <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1161</span>     <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1162</span>     <span class="n">write_data</span><span class="o">=</span><span class="n">write_data</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1163</span> <span class="p">)</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/zarr/core/array.py:4941,</span> in <span class="ni">create_array</span><span class="nt">(store, name, shape, dtype, data, chunks, shards, filters, compressors, serializer, fill_value, order, zarr_format, attributes, chunk_key_encoding, dimension_names, storage_options, overwrite, config, write_data)</span>
<span class="g g-Whitespace">   </span><span class="mi">4936</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4938</span> <span class="n">store_path</span> <span class="o">=</span> <span class="k">await</span> <span class="n">make_store_path</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4939</span>     <span class="n">store</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span>
<span class="g g-Whitespace">   </span><span class="mi">4940</span> <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">4941</span> <span class="k">return</span> <span class="k">await</span> <span class="n">init_array</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4942</span>     <span class="n">store_path</span><span class="o">=</span><span class="n">store_path</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4943</span>     <span class="n">shape</span><span class="o">=</span><span class="n">shape_parsed</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4944</span>     <span class="n">dtype</span><span class="o">=</span><span class="n">dtype_parsed</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4945</span>     <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4946</span>     <span class="n">shards</span><span class="o">=</span><span class="n">shards</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4947</span>     <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4948</span>     <span class="n">compressors</span><span class="o">=</span><span class="n">compressors</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4949</span>     <span class="n">serializer</span><span class="o">=</span><span class="n">serializer</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4950</span>     <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4951</span>     <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4952</span>     <span class="n">zarr_format</span><span class="o">=</span><span class="n">zarr_format</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4953</span>     <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4954</span>     <span class="n">chunk_key_encoding</span><span class="o">=</span><span class="n">chunk_key_encoding</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4955</span>     <span class="n">dimension_names</span><span class="o">=</span><span class="n">dimension_names</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4956</span>     <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4957</span>     <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4958</span> <span class="p">)</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/zarr/core/array.py:4724,</span> in <span class="ni">init_array</span><span class="nt">(store_path, shape, dtype, chunks, shards, filters, compressors, serializer, fill_value, order, zarr_format, attributes, chunk_key_encoding, dimension_names, overwrite, config)</span>
<span class="g g-Whitespace">   </span><span class="mi">4712</span>     <span class="n">meta</span> <span class="o">=</span> <span class="n">AsyncArray</span><span class="o">.</span><span class="n">_create_metadata_v2</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4713</span>         <span class="n">shape</span><span class="o">=</span><span class="n">shape_parsed</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4714</span>         <span class="n">dtype</span><span class="o">=</span><span class="n">zdtype</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>   <span class="mi">4721</span>         <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4722</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4723</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">4724</span>     <span class="n">array_array</span><span class="p">,</span> <span class="n">array_bytes</span><span class="p">,</span> <span class="n">bytes_bytes</span> <span class="o">=</span> <span class="n">_parse_chunk_encoding_v3</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4725</span>         <span class="n">compressors</span><span class="o">=</span><span class="n">compressors</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4726</span>         <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4727</span>         <span class="n">serializer</span><span class="o">=</span><span class="n">serializer</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4728</span>         <span class="n">dtype</span><span class="o">=</span><span class="n">zdtype</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">4729</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4730</span>     <span class="n">sub_codecs</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;tuple[Codec, ...]&quot;</span><span class="p">,</span> <span class="p">(</span><span class="o">*</span><span class="n">array_array</span><span class="p">,</span> <span class="n">array_bytes</span><span class="p">,</span> <span class="o">*</span><span class="n">bytes_bytes</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">4731</span>     <span class="n">codecs_out</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Codec</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/zarr/core/array.py:5263,</span> in <span class="ni">_parse_chunk_encoding_v3</span><span class="nt">(compressors, filters, serializer, dtype)</span>
<span class="g g-Whitespace">   </span><span class="mi">5260</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">5261</span>         <span class="n">maybe_bytes_bytes</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;Iterable[Codec | dict[str, JSON]]&quot;</span><span class="p">,</span> <span class="n">compressors</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">5263</span>     <span class="n">out_bytes_bytes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_parse_bytes_bytes_codec</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">maybe_bytes_bytes</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5265</span> <span class="c1"># TODO: ensure that the serializer is compatible with the ndarray produced by the</span>
<span class="g g-Whitespace">   </span><span class="mi">5266</span> <span class="c1"># array-array codecs. For example, if a sequence of array-array codecs produces an</span>
<span class="g g-Whitespace">   </span><span class="mi">5267</span> <span class="c1"># array with a single-byte data type, then the serializer should not specify endiannesss.</span>
<span class="g g-Whitespace">   </span><span class="mi">5268</span> 
<span class="g g-Whitespace">   </span><span class="mi">5269</span> <span class="c1"># TODO: add checks to ensure that the right serializer is used for vlen data types</span>
<span class="g g-Whitespace">   </span><span class="mi">5270</span> <span class="k">return</span> <span class="n">out_array_array</span><span class="p">,</span> <span class="n">out_array_bytes</span><span class="p">,</span> <span class="n">out_bytes_bytes</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/zarr/core/array.py:5263,</span> in <span class="ni">&lt;genexpr&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">   </span><span class="mi">5260</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">5261</span>         <span class="n">maybe_bytes_bytes</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;Iterable[Codec | dict[str, JSON]]&quot;</span><span class="p">,</span> <span class="n">compressors</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">5263</span>     <span class="n">out_bytes_bytes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_parse_bytes_bytes_codec</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">maybe_bytes_bytes</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5265</span> <span class="c1"># TODO: ensure that the serializer is compatible with the ndarray produced by the</span>
<span class="g g-Whitespace">   </span><span class="mi">5266</span> <span class="c1"># array-array codecs. For example, if a sequence of array-array codecs produces an</span>
<span class="g g-Whitespace">   </span><span class="mi">5267</span> <span class="c1"># array with a single-byte data type, then the serializer should not specify endiannesss.</span>
<span class="g g-Whitespace">   </span><span class="mi">5268</span> 
<span class="g g-Whitespace">   </span><span class="mi">5269</span> <span class="c1"># TODO: add checks to ensure that the right serializer is used for vlen data types</span>
<span class="g g-Whitespace">   </span><span class="mi">5270</span> <span class="k">return</span> <span class="n">out_array_array</span><span class="p">,</span> <span class="n">out_array_bytes</span><span class="p">,</span> <span class="n">out_bytes_bytes</span>

<span class="nn">File ~/micromamba/envs/DEVELOP/lib/python3.11/site-packages/zarr/registry.py:214,</span> in <span class="ni">_parse_bytes_bytes_codec</span><span class="nt">(data)</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">213</span>     <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">BytesBytesCodec</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">214</span>         <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected a BytesBytesCodec. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2"> instead.&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">215</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">data</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span> <span class="k">return</span> <span class="n">result</span>

<span class="ne">TypeError</span>: Expected a BytesBytesCodec. Got &lt;class &#39;numcodecs.blosc.Blosc&#39;&gt; instead.
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./budget_tutorial"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../bud_tut.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorials for Lagrangian tracer budget</p>
      </div>
    </a>
    <a class="right-next"
       href="particle_bud_tut.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tracking Labrador Sea Waterâ€™s with Lagrangian budget</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up">0.Set up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-wall-salinity">1. Calculate the wall salinity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-salinity-budget">2. Calculating the Salinity Budget</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-nabla-cdot-overline-u-overline-s">Calculate <span class="math notranslate nohighlight">\(\nabla\cdot{(\overline{u}\overline{S})}\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-divergence-of-adv-and-dif-terms">Calculate the divergence of ADV and DIF terms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-budget-closure">3. Check the budget closure</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Wenrui Jiang
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>